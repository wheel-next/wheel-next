
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../pepxxx_build_isolation_bypass/">
      
      
        <link rel="next" href="../../glossary/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>Wheel Variant Support - WheelNext</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/css/style.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pep-wheel-variants" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="WheelNext" class="md-header__button md-logo" aria-label="WheelNext" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WheelNext
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Wheel Variant Support
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/wheelnext/wheelnext" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="WheelNext" class="md-nav__button md-logo" aria-label="WheelNext" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    WheelNext
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/wheelnext/wheelnext" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to WheelNext
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../philosophy_and_design_space/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Philosophy and Design Space
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community_updates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Community Updates
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    WheelNext Proposals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            WheelNext Proposals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pep759_external_wheel_hosting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Wheel Hosting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pep766_explicit_priority_choices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index Prioritization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pep771_default_extras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Default Extra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pep777_how_to_reinvent_the_wheel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How To Reinvent the Wheel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pep778_symlink_support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symlink Support in Wheel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pepxxx_build_isolation_bypass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build Isolation Bypass
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Wheel Variant Support
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Wheel Variant Support
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    <span class="md-ellipsis">
      Motivation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rationale" class="md-nav__link">
    <span class="md-ellipsis">
      Rationale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rationale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-stories" class="md-nav__link">
    <span class="md-ellipsis">
      User Stories
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specification" class="md-nav__link">
    <span class="md-ellipsis">
      Specification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Specification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wheel-variants" class="md-nav__link">
    <span class="md-ellipsis">
      Wheel Variants
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#provider-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      Provider Plugins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-with-installers" class="md-nav__link">
    <span class="md-ellipsis">
      Integration with installers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backward-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      Backward Compatibility
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-implications" class="md-nav__link">
    <span class="md-ellipsis">
      Security Implications
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-teach-this" class="md-nav__link">
    <span class="md-ellipsis">
      How to Teach This
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Reference Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rejected-ideas" class="md-nav__link">
    <span class="md-ellipsis">
      Rejected Ideas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Open Issues
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    <span class="md-ellipsis">
      Motivation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rationale" class="md-nav__link">
    <span class="md-ellipsis">
      Rationale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rationale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-stories" class="md-nav__link">
    <span class="md-ellipsis">
      User Stories
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specification" class="md-nav__link">
    <span class="md-ellipsis">
      Specification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Specification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wheel-variants" class="md-nav__link">
    <span class="md-ellipsis">
      Wheel Variants
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#provider-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      Provider Plugins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-with-installers" class="md-nav__link">
    <span class="md-ellipsis">
      Integration with installers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backward-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      Backward Compatibility
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-implications" class="md-nav__link">
    <span class="md-ellipsis">
      Security Implications
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-teach-this" class="md-nav__link">
    <span class="md-ellipsis">
      How to Teach This
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Reference Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rejected-ideas" class="md-nav__link">
    <span class="md-ellipsis">
      Rejected Ideas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Open Issues
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="pep-wheel-variants">PEP ### - Wheel Variants<a class="headerlink" href="#pep-wheel-variants" title="Permanent link">&para;</a></h1>
<table>
<thead>
<tr>
<th>Resource</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>PEP Link</code></td>
<td><code>To Be Published</code></td>
</tr>
<tr>
<td><code>DPO Discussion</code></td>
<td><a href="https://discuss.python.org/t/implementation-variants-rehashing-and-refocusing/54884">Implementation variants: rehashing and refocusing</a></td>
</tr>
<tr>
<td><code>Github Repository</code></td>
<td><a href="https://github.com/wheelnext/pep_wheel_variants">https://github.com/wheelnext/pep_wheel_variants</a></td>
</tr>
</tbody>
</table>
<h2 id="abstract">Abstract<a class="headerlink" href="#abstract" title="Permanent link">&para;</a></h2>
<p>This PEP proposes an evolution of Python Wheels standard to support hardware-specific or platform-dependent package variants.
Current mechanisms for distinguishing Python Wheels (i.e Python ABI version, OS, CPU architecture, and Build ID) are
insufficient for modern hardware diversity, particularly for environments requiring specialized dependencies such as
high performance computing, accelerated computing (GPU, FPGA, ASIC, etc.), etc.</p>
<p>This proposal introduces <code>Wheel Variants</code>, a mechanism for publish platform-dependant wheels and selecting the most suitable
package variant for a given platform.</p>
<p>To enable fine-grained package selection without fragmenting the Python ecosystem, this PEP proposes:</p>
<ul>
<li>
<p>A <code>Wheel Variant</code> system that enables multiple wheels for the same Python package version, distinguished by
hardware-specific attributes.</p>
</li>
<li>
<p>A <code>Provider Plugin</code> system that dynamically detects platform attributes and recommends the most suitable wheel.</p>
</li>
<li>
<p>A hash-based identification mechanism for wheel variants, ensuring compatibility while maintaining clarity in package naming.</p>
</li>
</ul>
<p>This approach allows seamless package resolution without requiring intrusive changes to <code>installers</code>, ensures backward
compatibility, and minimizes the burden on package maintainers.</p>
<h2 id="motivation">Motivation<a class="headerlink" href="#motivation" title="Permanent link">&para;</a></h2>
<p>Existing approaches to handling platform-specific Python packages are suboptimal. Some methods include maintaining
separate package indexes for different hardware configurations, bundling all potential dependencies into a single
"mega-wheel," or creating separate package names (<code>mypackage-gpu</code>, <code>mypackage-cpu</code>). Each of these approaches has
significant drawbacks, such as excessive binary size, dependency confusion, and inefficient dependency resolution, etc.</p>
<p>The need for a systematic and scalable approach to selecting optimized wheels based on platform characteristics has
become increasingly urgent as Python usage expands across diverse computing environments, from cloud computing to
embedded systems and AI accelerators.</p>
<h2 id="rationale">Rationale<a class="headerlink" href="#rationale" title="Permanent link">&para;</a></h2>
<h3 id="user-stories">User Stories<a class="headerlink" href="#user-stories" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>A user wants to install a version of NumPy that is accelerated for their CPU architecture.</p>
</li>
<li>
<p>A user wants to install a version of PyTorch that is accelerated for their GPU architecture.</p>
</li>
<li>
<p>A user wants to install a version of mpi4py that has certain features enabled (e.g. specific MPI implementations for
their hardware).</p>
</li>
<li>
<p>A library maintainer wants to build their library for wasm32-wasi with and without pthreads support.</p>
</li>
<li>
<p>A library maintainer wants to build their library for an Emscripten platform for Pyodide with extensions for graphics
compiled in.</p>
</li>
<li>
<p>A library maintainer wants to provide packages of their game library using different graphics backends.</p>
</li>
<li>
<p>SciPy wants to provide packages built against different BLAS libraries, like OpenBLAS and Accelerate on macOS. This is something they <a href="https://github.com/wheelnext/wheelnext/pull/2#discussion_r1957200935">indirectly do today</a></p>
</li>
<li>
<p>Manylinux standard doesnâ€™t cover all use-cases: <a href="https://github.com/pypa/manylinux/issues/1725">github.com/pypa/manylinux/issues/1725</a></p>
</li>
</ul>
<h2 id="specification">Specification<a class="headerlink" href="#specification" title="Permanent link">&para;</a></h2>
<h3 id="wheel-variants">Wheel Variants<a class="headerlink" href="#wheel-variants" title="Permanent link">&para;</a></h3>
<p>A <code>Wheel Variant</code> is a Python Wheel designed to support a specific platform configuration. Wheel Variants will
follow an extended filename pattern, incorporating an additional hash to indicate a specific variant:</p>
<div class="highlight"><pre><span></span><code>mypackage-0.0.1~abcd1234-py3-none-any.whl
</code></pre></div>
<p>This <code>~abcd1234</code> hash is computed based on platform attributes detected by the user-installed <code>provider plugins</code> and
aggregated by <code>variantlib</code>, ensuring uniqueness and scalability while maintaining compatibility with existing tooling.
The <code>variantlib</code> library will generate these hashes using <code>hashlib.shake_128()</code>, providing a lightweight and
deterministic method of identifying platform-specific variants.</p>
<h3 id="provider-plugins">Provider Plugins<a class="headerlink" href="#provider-plugins" title="Permanent link">&para;</a></h3>
<p>A <code>Provider Plugin</code> detects the characteristics of the host platform and provides relevant metadata to <code>variantlib</code>.
Each plugin must implement a standard entry point:</p>
<div class="highlight"><pre><span></span><code><span class="k">[project.entry-points.</span><span class="s2">&quot;variantlib.plugins&quot;</span><span class="k">]</span>
<span class="n">my_plugin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my_plugin.plugin:MyVariantPlugin&quot;</span>
</code></pre></div>
<p>The plugin itself follows a minimal interface:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">variantlib.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProviderConfig</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">my_plugin</span><span class="w"> </span><span class="kn">import</span> <span class="n">__version__</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyVariantPlugin</span><span class="p">:</span>
    <span class="n">__provider_name__</span> <span class="o">=</span> <span class="s2">&quot;my_plugin&quot;</span>
    <span class="n">__version__</span> <span class="o">=</span> <span class="n">__version__</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ProviderConfig</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detects platform attributes and returns a ProviderConfig if applicable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div>
<h3 id="integration-with-installers">Integration with <code>installers</code><a class="headerlink" href="#integration-with-installers" title="Permanent link">&para;</a></h3>
<p>Upon package installation, <code>pip/uv/etc.</code> will:</p>
<ol>
<li>
<p>Query <code>variantlib</code> for installed <code>Provider Plugins</code>.</p>
</li>
<li>
<p>Generate a list of possible variant hashes based on detected attributes.</p>
</li>
<li>
<p>Search package repositories for matching wheels.</p>
</li>
<li>
<p>Select the most relevant variant based on predefined priority rules.</p>
</li>
<li>
<p>Install the selected wheel, or fall back to a generic version if no variant is found.</p>
</li>
<li>
<p>Users must have control over which plugins are active, with the ability to disable or prioritize them via <code>pip.conf</code>
or <code>variant.conf</code>.</p>
</li>
<li>
<p>A <code>[uv] pip install --no-variant package</code> option should be available to force installation of generic wheels.</p>
</li>
<li>
<p>A <code>[uv] pip install --variant=abcd1234 package</code> option should be available to force installation of generic wheels.</p>
</li>
<li>
<p>Platform detection can be expensive, it must be cache-able. The following caching policy might be a good start [ultimately up to the tool]</p>
<ul>
<li>Run once and cache</li>
<li>Void at restart</li>
<li>Void at plugin update</li>
<li>Void manually: <code>[uv] pip cache --void variant_cache</code></li>
</ul>
</li>
</ol>
<h2 id="backward-compatibility">Backward Compatibility<a class="headerlink" href="#backward-compatibility" title="Permanent link">&para;</a></h2>
<p>The introduction of <code>Wheel Variants</code> does not break existing <code>installer</code> [<code>pip/uv/etc.</code>] versions, as older versions
will simply ignore variant wheels. This is ensured by modifying the standard wheel filename regex ensures that legacy
<code>pip</code> versions do not mistakenly install incompatible variants.</p>
<h2 id="security-implications">Security Implications<a class="headerlink" href="#security-implications" title="Permanent link">&para;</a></h2>
<p>The <code>Provider Plugin</code> mechanism introduces potential security risks, such as untrusted plugins providing misleading
platform data. To mitigate this:</p>
<ul>
<li>Plugins should be sourced from trusted repositories. It's essentially remote code execution at install time.</li>
</ul>
<h2 id="how-to-teach-this">How to Teach This<a class="headerlink" href="#how-to-teach-this" title="Permanent link">&para;</a></h2>
<p>User documentation will be updated to:</p>
<ul>
<li>Explain the concept of <code>Wheel Variants</code> and how they improve package selection.</li>
<li>Provide guidance on writing and publishing <code>Provider Plugins</code>.</li>
<li>Detail configuration options, such as overriding variant selection or disabling the feature entirely.</li>
<li>Include debugging instructions for users encountering unexpected behavior.</li>
</ul>
<h2 id="reference-implementation">Reference Implementation<a class="headerlink" href="#reference-implementation" title="Permanent link">&para;</a></h2>
<p>A prototype implementation has been developed, demonstrating:</p>
<ul>
<li>
<p><code>variantlib</code>, the library handling plugin registration and variant selection.</p>
</li>
<li>
<p>Demo <code>Provider Plugins</code> capable of detecting <code>fictional  hardware</code> and <code>fictional technology</code></p>
</li>
<li>
<p>A modified version of <code>pip</code> integrating variant-aware package resolution.</p>
</li>
</ul>
<h2 id="rejected-ideas">Rejected Ideas<a class="headerlink" href="#rejected-ideas" title="Permanent link">&para;</a></h2>
<p>Several alternative approaches were considered and ultimately rejected:</p>
<ol>
<li>
<p><strong>Explicit Package Naming (<code>mypackage-gpu</code>, <code>mypackage-cpu</code>)</strong></p>
<ul>
<li>Leads to dependency resolution issues and combinatorial explosion of package variants.</li>
</ul>
</li>
<li>
<p><strong>Bundling All Dependencies into a Single Wheel</strong></p>
<ul>
<li>Results in unnecessarily large downloads and inefficiencies.</li>
</ul>
</li>
<li>
<p><strong>Modifying <code>pip</code> Internals Directly</strong></p>
<ul>
<li>Would impose significant maintenance burden on <code>pip</code> maintainers and slow adaptation to new hardware platforms.</li>
</ul>
</li>
<li>
<p><strong>One index per configuration</strong></p>
<ul>
<li>Significant user complexity. Force the user to carefully read the documentation.</li>
<li>Totally breaks the dependency tree: <code>transformers =&gt; pytorch</code></li>
</ul>
</li>
</ol>
<p><img alt="pytorch selector" src="../../assets/images/pytorch_variant_selector.webp" /></p>
<h2 id="open-issues">Open Issues<a class="headerlink" href="#open-issues" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Dependency Management</strong></p>
<ul>
<li>How should dependencies be expressed when a package depends on a variant of another package?</li>
</ul>
</li>
<li>
<p><strong>Lockfile Support</strong></p>
<ul>
<li>Should lockfiles store variant hashes or remain variant-agnostic?</li>
</ul>
</li>
<li>
<p><strong>Platform Detection Edge Cases</strong></p>
<ul>
<li>How should plugins handle ambiguous or incomplete hardware information?</li>
<li>Probably should stay up to the plugin maintainer to decide.</li>
</ul>
</li>
<li>
<p><strong>How to maintain a source-of-truth</strong></p>
<ul>
<li>Everybody who build CUDA-accelerated Wheel Variants need to use <strong>exactly</strong> the metadata that will
be provided to installers.</li>
<li>Same logic for CPU, every <code>AVX512</code> accelerated package need to highlight that feature in the exact same way.</li>
<li>Shall we have a package like <code>troveclassifiers</code> to act as a "source of truth" ?</li>
</ul>
</li>
</ol>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>This proposal outlines a scalable and backward-compatible solution for platform-specific Python Wheel distribution.
By leveraging <code>Wheel Variants</code> and <code>Provider Plugins</code>, this mechanism simplifies package installation for users while
maintaining efficiency for package maintainers and repository hosts.</p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 20, 2025</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 12, 2025</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/wheelnext/wheelnext" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/wheelnext/wheelnext/blob/main/LICENSE" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 10a3.04 3.04 0 0 1 3-3 3.04 3.04 0 0 1 3 3 3.04 3.04 0 0 1-3 3 3.04 3.04 0 0 1-3-3m3 9 4 1v-3.08A7.54 7.54 0 0 1 12 18a7.54 7.54 0 0 1-4-1.08V20m4-16a5.78 5.78 0 0 0-4.24 1.74A5.78 5.78 0 0 0 6 10a5.78 5.78 0 0 0 1.76 4.23A5.78 5.78 0 0 0 12 16a5.78 5.78 0 0 0 4.24-1.77A5.78 5.78 0 0 0 18 10a5.78 5.78 0 0 0-1.76-4.26A5.78 5.78 0 0 0 12 4m8 6a8 8 0 0 1-.57 2.8A7.8 7.8 0 0 1 18 15.28V23l-6-2-6 2v-7.72A7.9 7.9 0 0 1 4 10a7.68 7.68 0 0 1 2.33-5.64A7.73 7.73 0 0 1 12 2a7.73 7.73 0 0 1 5.67 2.36A7.68 7.68 0 0 1 20 10"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>